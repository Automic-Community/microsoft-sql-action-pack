*** Settings ***
Documentation     THIS CONTEXT FILE WORKING WITH AUTOMATED TEST SYSTEM
Resource          ../env/default.txt
Resource          actions.txt

*** Variables ***
#- CONTEXT VARIABLES ---
${_AGENT}         /
${_LOGIN}         /
${_CURRENT_TIMESTAMP_}    /
${_WORKING_DIR}    /
${_CONN_STRING}    /
${_JAR}           /
${_CLASS}         /
${_DB_NAME}       /
${_DB_NAME_WITH_SPACE}    DEV MSSQL WITH SPACE
${_SERVER}        /
${_DB_USERNAME}    /
${_DB_PASSWORD}    /
${_INTRVL}        /
${_RETRY}         /
${_ROLE_NAME}     /
${_DATA_DIR}      /

*** Key Words ***
Init Agent
    [Documentation]    Requirement
    Run Keyword If    '${ENV}' == 'VVNARASQL04' and '${APP}' == 'MSSQL2012'    Init MSSQL 2012
    Run Keyword If    '${ENV}' == 'VVNARASQL04' and '${APP}' == 'MSSQL2008'    Init MSSQL 2008
    Run Keyword If    '${ENV}' == 'VVNFIBOTOOL01' and '${APP}' == 'MSSQL2008R2'    Init MSSQL 2008 R2
    Run Keyword If    '${ENV}' == 'VVNFIBOTOOL01' and '${APP}' == 'MSSQL2005'    Init MSSQL 2005
    Run Keyword If    '${ENV}' == 'VVNDEMO08' and '${APP}' == 'VVNDEMO08'    Init VVNDEMO08

Suite Setup
    Action Connect    ${_AE_HOST}    ${_AE_PORT}    ${_AE_USER}    ${_AE_PASS}    ${_AE_TEMP_FOLD}
    Init Server
    Run Keyword If    '${OS}' == 'UNIX11'    Init Unix Server 11

Init MSSQL 2005
    [Documentation]    TODO: Write server description here
    Set Global Variable    ${_AGENT}    VVNFIBOTOOL01
    Set Global Variable    ${_LOGIN}    VVNSAT.LOGIN_ALL
    Set Global Variable    ${_WORKING_DIR}    C:/temp
    Set Global Variable    ${/}    \\
    Set Global Variable    ${_DB_USERNAME}    AT
    Set Global Variable    ${_DB_PASSWORD}    AT
    Set Global Variable    ${_CONN_STRING}    jdbc:sqlserver://VVNFIBOTOOL01\\SQLSERVER2005:1444;
    Set Global Variable    ${_JAR}    file:///C:/mssql_testdata/sqljdbc4.jar
    Set Global Variable    ${_CLASS}    com.microsoft.sqlserver.jdbc.SQLServerDriver
    Set Global Variable    ${_INTRVL}    10
    Set Global Variable    ${_RETRY}    2
    Set Global Variable    ${ERROR_CODE}    12
    Set Global Variable    ${_SERVER}    VVNFIBOTOOL01\SQLSERVER2005
    Set Global Variable    ${ROLE_NAME}    db_datawriter
    Set Global Variable    ${_DB_NAME}    DEV_MSSQL
    Set Global Variable    ${_DB_NAME_AT}    ATDB
    Set Global Variable    ${_DATA_DIR}    C:\\Program Files\\Microsoft SQL Server\\MSSQL11.MSSQLSERVER\\MSSQL\\DATA\\

Init MSSQL 2008
    [Documentation]    TODO: Write server description here
    Set Global Variable    ${_AGENT}    VVNARASQL04
    Set Global Variable    ${_LOGIN}    VVNSAT.LOGIN_ALL
    Set Global Variable    ${_WORKING_DIR}    C:/temp
    Set Global Variable    ${/}    \\
    Set Global Variable    ${_DB_USERNAME}    AT
    Set Global Variable    ${_DB_PASSWORD}    AT
    Set Global Variable    ${_CONN_STRING}    jdbc:sqlserver://VVNARASQL04\\SQLEXPRESS:1444;
    Set Global Variable    ${_JAR}    file:///C:/mssql_testdata/sqljdbc4.jar
    Set Global Variable    ${_CLASS}    com.microsoft.sqlserver.jdbc.SQLServerDriver
    Set Global Variable    ${_INTRVL}    10
    Set Global Variable    ${_RETRY}    2
    Set Global Variable    ${ERROR_CODE}    12
    Set Global Variable    ${_SERVER}    VVNARASQL04\SQLEXPRESS
    Set Global Variable    ${ROLE_NAME}    db_datawriter
    Set Global Variable    ${_DB_NAME}    DEV_MSSQL
    Set Global Variable    ${_DATA_DIR}    C:\\Program Files\\Microsoft SQL Server\\MSSQL11.MSSQLSERVER\\MSSQL\\DATA\\

Init MSSQL 2008 R2
    [Documentation]    TODO: Write server description here
    Set Global Variable    ${_AGENT}    VVNFIBOTOOL01
    Set Global Variable    ${_LOGIN}    VVNSAT.LOGIN_ALL
    Set Global Variable    ${_WORKING_DIR}    C:/temp
    Set Global Variable    ${/}    \\
    Set Global Variable    ${_DB_USERNAME}    AT
    Set Global Variable    ${_DB_PASSWORD}    AT
    Set Global Variable    ${_CONN_STRING}    jdbc:sqlserver://VVNFIBOTOOL01:1433;
    Set Global Variable    ${_JAR}    file:///C:/mssql_testdata/sqljdbc4.jar
    Set Global Variable    ${_CLASS}    com.microsoft.sqlserver.jdbc.SQLServerDriver
    Set Global Variable    ${_INTRVL}    10
    Set Global Variable    ${_RETRY}    2
    Set Global Variable    ${ERROR_CODE}    12
    Set Global Variable    ${_SERVER}    VVNFIBOTOOL01
    Set Global Variable    ${ROLE_NAME}    db_datawriter
    Set Global Variable    ${_DB_NAME}    DEV_MSSQL
    Set Global Variable    ${_DATA_DIR}    C:\\Program Files\\Microsoft SQL Server\\MSSQL11.MSSQLSERVER\\MSSQL\\DATA\\

Init MSSQL 2012
    [Documentation]    TODO: Write server description here
    Set Global Variable    ${_AGENT}    VVNARASQL04
    Set Global Variable    ${_LOGIN}    VVNSAT.LOGIN_ALL
    Set Global Variable    ${_WORKING_DIR}    C:/temp
    Set Global Variable    ${/}    \\
    Set Global Variable    ${_DB_USERNAME}    AT
    Set Global Variable    ${_DB_PASSWORD}    AT
    Set Global Variable    ${_CONN_STRING}    jdbc:sqlserver://VVNARASQL04:1433;
    Set Global Variable    ${_CONN_STRING_AT}    jdbc:sqlserver://VVNARASQL04:1433;
    Set Global Variable    ${_JAR}    file:///C:/mssql_testdata/sqljdbc4.jar
    Set Global Variable    ${_CLASS}    com.microsoft.sqlserver.jdbc.SQLServerDriver
    Set Global Variable    ${_INTRVL}    10
    Set Global Variable    ${_RETRY}    2
    Set Global Variable    ${ERROR_CODE}    12
    Set Global Variable    ${_SERVER}    VVNARASQL04
    Set Global Variable    ${ROLE_NAME}    db_datawriter
    Set Global Variable    ${_DB_NAME}    DEV_MSSQL
    Set Global Variable    ${_DATA_DIR}    C:\\Program Files\\Microsoft SQL Server\\MSSQL11.MSSQLSERVER\\MSSQL\\DATA\\

Init VVNDEMO08
    [Documentation]    TODO: Write server description here
    Set Global Variable    ${_AGENT}    VVNDEMO08
    Set Global Variable    ${_LOGIN}    VVNSAT.LOGIN_ALL
    Set Global Variable    ${_WORKING_DIR}    C:/temp
    Set Global Variable    ${/}    \\
    Set Global Variable    ${_DB_USERNAME}    AT
    Set Global Variable    ${_DB_PASSWORD}    AT
    Set Global Variable    ${_CONN_STRING}    jdbc:sqlserver://VVNDEMO08:1433;
    Set Global Variable    ${_CONN_STRING_AT}    jdbc:sqlserver://VVNDEMO08:1433;
    Set Global Variable    ${_JAR}    file:///C:/ARAconfig/sqljdbc42.jar
    Set Global Variable    ${_CLASS}    com.microsoft.sqlserver.jdbc.SQLServerDriver
    Set Global Variable    ${_INTRVL}    10
    Set Global Variable    ${_RETRY}    2
    Set Global Variable    ${ERROR_CODE}    12
    Set Global Variable    ${_SERVER}    VVNDEMO08
    Set Global Variable    ${ROLE_NAME}    db_datawriter
    Set Global Variable    ${_DB_NAME}    DEV_MSSQL
    Set Global Variable    ${_DATA_DIR}    C:\\Program Files\\Microsoft SQL Server\\MSSQL13.MSSQLSERVER\\MSSQL\\DATA\\