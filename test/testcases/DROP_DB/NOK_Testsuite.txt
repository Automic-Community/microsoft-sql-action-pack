*** Settings ***
Documentation     NOTE:
...               add note here
Suite Setup       Setup_suite
Suite Teardown    Teardown_suite
Force Tags        windows
Test Template     Drop a database
Resource          ../../resources/keywords.txt
Resource          ../../resources/context.txt

*** Variables ***
${TEMP_DB_NAME}    DB_TO_DROP

*** Test Cases ***    Username             Password             JDBC Connection String    JDBC Driver JAR URI    JDBC Driver Class    Connection Interval    No of Connection Retries    DB Name to drop           Fail if not DB exits    RETCODE    STATUS
Wrong User Input Should Fail
                      ${_DB_USERNAME}_a    ${_DB_PASSWORD}      ${_CONN_STRING}           ${_JAR}                ${_CLASS}            ${_INTRVL}             ${_RETRY}                   ${_DB_NAME}               NO                      0          ${ENDED_NOK}

Wrong Password Input Should Fail
                      ${_DB_USERNAME}      ${_DB_PASSWORD}_b    ${_CONN_STRING}           ${_JAR}                ${_CLASS}            ${_INTRVL}             ${_RETRY}                   ${_DB_NAME}               NO                      0          ${ENDED_NOK}

Wrong JDBC Conn String Input Should Fail
                      ${_DB_USERNAME}      ${_DB_PASSWORD}      ${_CONN_STRING}_c         ${_JAR}                ${_CLASS}            ${_INTRVL}             ${_RETRY}                   ${_DB_NAME}               NO                      0          ${ENDED_NOK}

Wrong JDBC Driver JAR Input Should Fail
                      ${_DB_USERNAME}      ${_DB_PASSWORD}      ${_CONN_STRING}           ${_JAR}_d              ${_CLASS}            ${_INTRVL}             ${_RETRY}                   ${_DB_NAME}               NO                      0          ${ENDED_NOK}

Wrong JDBC Driver Class Input Should Fail
                      ${_DB_USERNAME}      ${_DB_PASSWORD}      ${_CONN_STRING}           ${_JAR}                ${_CLASS}_e          ${_INTRVL}             ${_RETRY}                   ${_DB_NAME}               NO                      0          ${ENDED_NOK}

Wrong DB Name To Drop & Fail If Exist = YES Input Should Fail
                      ${_DB_USERNAME}      ${_DB_PASSWORD}      ${_CONN_STRING}           ${_JAR}                ${_CLASS}            ${_INTRVL}             ${_RETRY}                   ${_DB_NAME}_invalid___    YES                     0          ${ENDED_NOK}

*** Keywords ***
Drop a database
    [Arguments]    ${username}    ${password}    ${jdbc_conn}    ${jdbc_jar}    ${jdbc_class}    ${interval}
    ...    ${retries}    ${db_name}    ${fail_if_not_exists}    ${returnCode}    ${returnStatus}
    Init Action    ${ACTION_DROP_DB}
    Action Set    ${PRT_DROP_DB_USERNAME}    ${username}
    Action Set    ${PRT_DROP_DB_PASSWORD}    ${password}
    Action Set    ${PRT_DROP_DB_JDBC_CONN_STRING}    ${jdbc_conn}
    Action Set    ${PRT_DROP_DB_DRIVER_JAR}    ${jdbc_jar}
    Action Set    ${PRT_DROP_DB_DRIVER_CLASS}    ${jdbc_class}
    Action Set    ${PRT_DROP_DB_CONN_INTRVL}    ${interval}
    Action Set    ${PRT_DROP_DB_CONN_RETRY}    ${retries}
    Action Set    ${PRT_DROP_DB_DROP_DBNAME}    ${db_name}
    Action Set    ${PRT_DROP_DB_FAIL_DB_NOT_EXISTS}    ${fail_if_not_exists}
    Action Execute
    Action Report Should Be Found
    Action Return Code Should Not Equal    ${returnCode}
    Action Return Status Should Be    ${returnStatus}

Setup_suite
    [Documentation]    TODO: Write all steps need prepare before testing here
    Log    Start testing for Drop a database backup
    Create Database    ${_DB_USERNAME}    ${_DB_PASSWORD}    ${_CONN_STRING}    ${_JAR}    ${_CLASS}    ${_INTRVL}
    ...    ${_RETRY}    ${TEMP_DB_NAME}    ${EMPTY}    ${EMPTY}    ${EMPTY}    NO
    ...    OFF    OFF    0    ${ENDED_OK}

Teardown_suite
    Drop a database    ${_DB_USERNAME}    ${_DB_PASSWORD}    ${_CONN_STRING}    ${_JAR}    ${_CLASS}    ${_INTRVL}
    ...    ${_RETRY}    ${TEMP_DB_NAME}    NO    1    ${ENDED_OK}
