*** Settings ***
Documentation     NOTE:
...               add note here
Suite Setup       Setup_suite
Force Tags        windows
Test Template     Create a database backup
Resource          ../../resources/keywords.txt
Resource          ../../resources/context.txt

*** Test Cases ***    Username           Password           JDBC Connection String    JDBC Driver JAR URI    JDBC Driver Class    Connection Interval    No of Connection Retries    DB Name to backup    File to include    Group file to include    List of target disks                     List of minor disks    List of target tapes    List of minor tapes    Differential backup    Copy-only backup    Description    Backupset name    Expires    Expires date    Remain days    Mediaset init    Mediaset skip    Mediaset format    Mediaset description    Name of media    Media blocksize    Datatransfer blockcount    Datatransfer maximum transfer size    Error management checksum    Error management stop on error    Tape rewind    Tape unload    RETCODE    STATUS
1. Normal case success with only required fields
                      ${_DB_USERNAME}    ${_DB_PASSWORD}    ${_CONN_STRING}           ${_JAR}                ${_CLASS}            ${_INTRVL}             ${_RETRY}                   ${_DB_NAME}          ${EMPTY}           ${EMPTY}                 'C:\\temp\\at.bck','C:\\temp\\at.bck'    ${EMPTY}               ${EMPTY}                ${EMPTY}               NO                     NO                  ${EMPTY}       ${EMPTY}          NO         ${EMPTY}        -1             NO               NO               ON                 ${EMPTY}                ${EMPTY}         -1                 -1                         -1                                    NO                           YES                               YES            YES            0          ${ENDED_OK}

*** Keywords ***
Create a database backup
    [Arguments]    ${username}    ${password}    ${jdbc_conn}    ${jdbc_jar}    ${jdbc_class}    ${interval}
    ...    ${retries}    ${db_name}    ${file_to_include}    ${file_group_to_include}    ${target_disks}    ${minor_disks}
    ...    ${target_tapes}    ${minor_tapes}    ${differential}    ${common_only}    ${description}    ${backupset_name}
    ...    ${expires}    ${expire_date}    ${retain_days}    ${mediaset_init}    ${mediaset_skip}    ${mediaset_format}
    ...    ${mediaset_description}    ${name_of_media}    ${media_blocksize}    ${datatransfer_blockcount}    ${datatransfer_maximum}    ${error_management_checksum}
    ...    ${stop_on_error}    ${tape_rewind}    ${tape_unload}    ${returnCode}    ${returnStatus}
    Init Action    ${ACTION_DB_BACKUP}
    Action Set    ${PRT_CREATE_DB_BACKUP_DB_USERNAME}    ${username}
    Action Set    ${PRT_CREATE_DB_BACKUP_DB_PASSWORD}    ${password}
    Action Set    ${PRT_CREATE_DB_BACKUP_DB_JDBC_CONN_STRING}    ${jdbc_conn}
    Action Set    ${PRT_CREATE_DB_BACKUP_DB_DRIVER_JAR}    ${jdbc_jar}
    Action Set    ${PRT_CREATE_DB_BACKUP_DB_DRIVER_CLASS}    ${jdbc_class}
    Action Set    ${PRT_CREATE_DB_BACKUP_DB_CONN_INTRVL}    ${interval}
    Action Set    ${PRT_CREATE_DB_BACKUP_DB_CONN_RETRY}    ${retries}
    Action Set    ${PRT_CREATE_DB_BACKUP_DB_BACKUP_DATABASE_NAME}    ${db_name}
    Action Set    ${PRT_CREATE_DB_BACKUP_DB_BACKUP_FILES}    ${file_to_include}
    Action Set    ${PRT_CREATE_DB_BACKUP_DB_BACKUP_FILEGROUPS}    ${file_group_to_include}
    Action Set    ${PRT_CREATE_DB_BACKUP_DB_BACKUP_TO_DISKS}    ${target_disks}
    Action Set    ${PRT_CREATE_DB_BACKUP_DB_MIRROR_TO_DISKS}    ${minor_disks}
    Action Set    ${PRT_CREATE_DB_BACKUP_DB_BACKUP_TO_TAPES}    ${target_tapes}
    Action Set    ${PRT_CREATE_DB_BACKUP_DB_MIRROR_TO_TAPES}    ${minor_tapes}
    Action Set    ${PRT_CREATE_DB_BACKUP_DB_BACKUPSET_DIFF}    ${differential}
    Action Set    ${PRT_CREATE_DB_BACKUP_DB_BACKUPSET_COPY_ONLY}    ${common_only}
    Action Set    ${PRT_CREATE_DB_BACKUP_DB_BACKUPSET_DESCRIPTION}    ${description}
    Action Set    ${PRT_CREATE_DB_BACKUP_DB_BACKUPSET_NAME}    ${backupset_name}
    Action Set    ${PRT_CREATE_DB_BACKUP_DB_BACKUP_EXPIRE_ON_DATE}    ${expires}
    Action Set    ${PRT_CREATE_DB_BACKUP_DB_BACKUP_EXPIRE_DATE}    ${expire_date}
    Action Set    ${PRT_CREATE_DB_BACKUP_DB_BACKUPSET_RETAIN_DAYS}    ${retain_days}
    Action Set    ${PRT_CREATE_DB_BACKUP_DB_MEDIASET_INIT}    ${mediaset_init}
    Action Set    ${PRT_CREATE_DB_BACKUP_DB_MEDIASET_SKIP}    ${mediaset_skip}
    Action Set    ${PRT_CREATE_DB_BACKUP_DB_MEDIASET_FORMAT}    ${mediaset_format}
    Action Set    ${PRT_CREATE_DB_BACKUP_DB_MEDIASET_DSCR}    ${mediaset_description}
    Action Set    ${PRT_CREATE_DB_BACKUP_DB_MEDIASET_MEDIANAME}    ${name_of_media}
    Action Set    ${PRT_CREATE_DB_BACKUP_DB_MEDIASET_BLOCKSIZE}    ${media_blocksize}
    Action Set    ${PRT_CREATE_DB_BACKUP_DB_DATATF_BUFFERCOUNT}    ${datatransfer_blockcount}
    Action Set    ${PRT_CREATE_DB_BACKUP_DB_DATATF_MAXTRFSIZE}    ${datatransfer_maximum}
    Action Set    ${PRT_CREATE_DB_BACKUP_DB_ERRMGMT_CHECKSUM}    ${error_management_checksum}
    Action Set    ${PRT_CREATE_DB_BACKUP_DB_ERRMGMT_STOP_ON_ERR}    ${stop_on_error}
    Action Set    ${PRT_CREATE_DB_BACKUP_DB_TAPE_REWIND}    ${tape_rewind}
    Action Set    ${PRT_CREATE_DB_BACKUP_DB_TAPE_UNLOAD}    ${tape_unload}
    Action Execute
    Action Report Should Be Found
    Action Return Code Should Be    ${returnCode}
    Action Return Status Should Be    ${returnStatus}

Setup_suite
    [Documentation]    TODO: Write all steps need prepare before testing here
    Log    Start testing for Create a database backup
